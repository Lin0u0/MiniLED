# MiniLED 分区背光控制器 - 控制方案

## 控制逻辑

| 控制方式 | 功能 | 状态显示 |
|---------|------|---------|
| **拨码开关** | 背光功能控制 (实时) | LED3-2 |
| **按键** | 算法模式切换 (消抖) | LED1-0 |

---

## 拨码开关 (背光功能)

低电平有效 (拨到 **ON** 位置为开启功能)

| 开关 | 管脚 | 功能 | LED |
|-----|------|------|-----|
| **SW1** | W20 | 分区背光开关 | LED3 |
| **SW2** | V20 | 自动亮度开关 | LED2 |

### 使用组合

| SW1 (分区) | SW2 (自动) | LED3 | LED2 | 效果 |
|-----------|-----------|------|------|------|
| OFF | OFF | 灭 | 灭 | 全区固定亮度 (最亮) |
| ON | OFF | 亮 | 灭 | 纯分区背光 (360区独立) |
| OFF | ON | 灭 | 亮 | 全区固定 + 自动亮度 (无效组合) |
| ON | ON | 亮 | 亮 | 分区背光 + 自动亮度调节 |

> **推荐设置**: SW1=ON, SW2=ON (分区背光 + 自动亮度)

---

## 按键 (算法模式)

低电平有效 (按下触发)，带 **10ms 消抖**

| 按键 | 管脚 | 功能 | LED1:0 |
|-----|------|------|--------|
| **KEY1** | T18 | RMS 算法 | 00 |
| **KEY2** | R18 | Mean-Corrected Max | 01 |
| **KEY3** | U20 | Average | 10 |
| **KEY4** | T20 | Correction | 11 |

### 算法说明

| 模式 | 名称 | 特点 |
|-----|------|------|
| **RMS** | 均方根 | 计算 24×15 像素块平方均值开方，最接近人眼感知 |
| **Max** | 均值校正最大值 | 最大+平均混合，平衡对比度和功耗 |
| **Ave** | 平均值 | 简单平均，平滑过渡 |
| **Cor** | 校正 | 补偿算法，精确控制 |

> **默认模式**: Mean-Corrected Max (Max)

---

## LED 显示

```
┌─────┬─────┬─────┬─────┐
│LED3 │LED2 │LED1 │LED0 │
├─────┼─────┼─────┼─────┤
│分区 │自动 │     算法模式     │
│背光 │亮度 │  00/01/10/11   │
└─────┴─────┴─────┴─────┘
```

**示例显示解读**:
- `亮 亮 0 0` = 分区背光 + 自动亮度 + RMS算法
- `亮 灭 0 1` = 分区背光 + 固定亮度 + Max算法
- `灭 灭 1 0` = 全区固定 + Ave算法 (最耗电)

---

## 快速开始

### 1. 最佳画质模式
1. SW1 拨到 **ON** (分区背光)
2. SW2 拨到 **ON** (自动亮度)
3. 按 **KEY1** (RMS算法)

### 2. 节能模式
1. SW1 拨到 **ON** (分区背光)
2. SW2 拨到 **ON** (自动亮度)
3. 按 **KEY2** (Max算法)

### 3. 对比演示模式
1. SW1 拨到 **OFF** (全区固定)
2. 观察屏幕亮度
3. SW1 拨到 **ON** (分区背光)
4. 对比暗场画面的黑位表现

---

## 技术参数

| 参数 | 值 |
|-----|---|
| 消抖时间 | 10ms (500000 @ 50MHz) |
| 按键响应 | 下降沿触发 |
| 拨码响应 | 实时电平 |
| 默认算法 | Mean-Corrected Max |
| 分区数 | 360 (24×15) |

---

## 管脚汇总

```
拨码开关 (BANK_3, 1.5V):
  SW1 → W20 (分区背光开关)
  SW2 → V20 (自动亮度开关)

按键 (BANK_3, 1.5V):
  KEY1 → T18 (RMS)
  KEY2 → R18 (Max)
  KEY3 → U20 (Ave)
  KEY4 → T20 (Cor)

LED (BANK_3, 3.3V):
  LED3 → T17 (分区背光状态)
  LED2 → U17 (自动亮度状态)
  LED1 → U19 (算法高位)
  LED0 → U18 (算法低位)
```

---

## 与旧设计对比

| | 旧设计 | 新设计 |
|--|-------|-------|
| 拨码开关 | 控制4种背光模式 | 控制2个功能开关 |
| 按键 | 无 | 控制4种算法模式 |
| LED | 显示单一模式 | 功能+算法组合显示 |
| 操作逻辑 | 模式编号记忆 | 功能直观控制 |

**优势**:
- 拨码开关适合实时切换常用功能
- 按键适合选择算法 (不需要频繁切换)
- LED 同时显示功能和算法状态
